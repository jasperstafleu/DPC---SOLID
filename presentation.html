<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Several years of SOLID development - DPC 2017</title>

    <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="theme/css/developers.nl.css">
    <link rel="stylesheet" href="node_modules/highlight.js/styles/github.css">

    <link rel="stylesheet" href="assets/style.css">

    <link href='http://fonts.googleapis.com/css?family=Roboto%20Mono' rel='stylesheet' type='text/css'>
</head>
<body>
<div class="reveal large-sun">
    <div id="white-pane" style="display: none;"></div>
    <div id="clouds">
        <div class="cloud-1"></div>
        <div class="cloud-2"></div>
    </div>

    <div class="slides">
        <section class="first-slide with-clouds">
            <article>
                <header>
                    <h1>Several years of SOLID-aware development</h1>
                    <small>Or: How other programmers keep making my work harder</small>
                </header>
            </article>
        </section>

        <section>
            <header>
                <h2>About me</h2>
                <small>Who the hell is this guy?</small>
            </header>
            <article>
                <figure class="jasper-logo">
                    <img src="assets/jasper.jpg">
                </figure>
                <ul style="line-height: 1.3;">
                    <li>Jasper Stafleu</li>
                    <li>MSc Computer Science</li>
                    <li style="margin-top: 1em;">
                        Developers.nl
                        <ul>
                            <li>
                                Logius (Ministerie BiZa)<br/>
                                <a href="https://mijn.overheid.nl/" target="_blank" rel="noreferrer noopener">https://mijn.overheid.nl/</a>
                            </li>
                            <li>
                                Beslist.nl<br/>
                                <a href="http://beslist.nl/" target="_blank" rel="noreferrer noopener">http://beslist.nl/</a>
                            </li>
                            <li>
                                SBS<br/>
                                <a href="http://www.kijk.nl/" target="_blank" rel="noreferrer noopener">http://www.kijk.nl/</a>
                            </li>
                            <li>
                                and many others...
                            </li>
                        </ul>
                    </li>
                </ul>
            </article>
        </section>

        <section>
            <header>
                <h2>SOLID</h2>
                <small><abbr title="Yet another acronym">YAA</abbr> (Yet another acronym)</small>
            </header>
            <article>
                <ul class="acronym">
                    <li>Single Responsibility</li>
                    <li>Open-Closed</li>
                    <li><mark class="fragment" data-fragment-index="1">Liskov Substitution</mark></li>
                    <li>Interface Segregation</li>
                    <li><mark class="fragment" data-fragment-index="1">Dependency Inversion</mark></li>
                </ul>
            </article>
            <aside class="notes">
                <ul>
                    <li>SOLID is about behavior, not coding per se</li>
                    <li>Object Oriented Design => actually any Component based system</li>
                    <li>Reusability (unit tests) and maintainability of code</li>
                    <li>Object oriented design is subservient to SOLID, not the other way around</li>
                </ul>
            </aside>
        </section>

        <section class="with-clouds">
            <article>
                <header>
                    <h2>Single Responsibility</h2>
                    <small>My precioussss...</small>
                </header>
            </article>
            <aside class="notes">
                <ul>
                    <li>Responsibility goes two ways!!!</li>
                    <li>PHP:
                        <ul>
                            <li>Mostly done OK, easy to spot if not</li>
                            <li>Low hanging fruit</li>
                        </ul>
                    </li>
                </ul>
            </aside>
        </section>

        <section class="with-clouds">
            <article>
                <header>
                    <h2>Interface Segregation</h2>
                    <small>Interfaces have responsibilities as well. Really!</small>
                </header>
            </article>
            <aside class="notes">
                <ul>
                    <li>Single responsibility for interfaces</li>
                    <li>PHP:
                        <ul>
                            <li>Rarely done right</li>
                            <li>Multiple interface inheritance / implementation makes this easy to do</li>
                        </ul>
                    </li>
                </ul>
            </aside>
        </section>

        <section class="with-clouds">
            <article>
                <header>
                    <h2>Open / Closed</h2>
                    <small>Don’t touch me!<br/> Let’s make kids instead</small>
                </header>
            </article>
            <aside class="notes">
                <b>Closed</b>
                <ul>
                    <li>PHP: Used to be a problem, until the rise of composer</li>
                </ul>
                <b>Open</b>
                <ul>
                    <li>Mainly a problem for library code</li>
                    <li>PHP: Often a problem
                        <ul>
                            <li>Doctrine Query object</li>
                            <li>Final Keyword</li>
                            <li>Private vs Protected</li>
                            <li>NewRelic automagic symfony2 interpretation</li>
                        </ul>
                    </li>
                </ul>
            </aside>
        </section>

        <!-- LSP -->
        <section>
            <section class="with-clouds">
                <article>
                    <header>
                        <h2>Liskov Substitution</h2>
                        <small>Keep your promises!</small>
                    </header>
                </article>
                <aside class="notes">
                    <ul>
                        <li>Named after Barbara Liskov</li>
                        <li>Strong behavioural subtyping</li>
                    </ul>
                </aside>
            </section>

            <section>
                <header>
                    <h3>Definition</h3>
                    <small>Huh?</small>
                </header>
                <article>
                    <q>
                        Let <strong>φ(x)</strong> be a property provable about objects <strong>x</strong> of type <strong>T</strong>.
                        <br/>
                        Then <strong>φ(y)</strong> should be true for objects <strong>y</strong> of type <strong>S</strong>
                        where <strong>S</strong> is a subtype of <strong>T</strong>.
                        <sup><a href="#further-reading">[1]</a></sup>
                    </q>
                </article>
                <aside class="notes">
                    <ul>
                        <li>Mathspeak is fun! But, regrettably, its implications are not easily understood.</li>
                        <li>Show of hands: who gets it now?</li>
                        <li>
                            Any class should be allowed to be replaced with an instance of a subtype of that class
                            without altering the correctness of the program.
                        </li>
                    </ul>
                </aside>
            </section>

            <section>
                <header>
                    <h3>Example</h3>
                    <small>Oh, so it is actually trivial!</small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
class Origami
{
    /**
     * Magically transforms a piece of paper into a
     * jumbo jet.
     *
     * @param Paper $paper
     * @return JumboJet
     */
    public function makeAirplane(Paper $paper)
    {
        // ...
    }
}

class Paper
{
    // ...
}

class Papyrus extends Paper
{
    // ...
}

(new Origami)->makeAirplane(new Papyrus);
                    </code></pre>
                </article>
                <aside class="notes">
                    <ul>
                        <li>Papyrus can be used </li>
                        <li>But remember: it should behave the same! So it is not this simple</li>
                    </ul>
                </aside>
            </section>

            <section>
                <header>
                    <h3>Exceptions</h3>
                    <small>Hmmm, not as trivial as it looks</small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
class Origami
{
    public function makeAirplane(Paper $paper)
    {
        $paper->fold();
    }
}

class Paper
{
    /**
     * Folds the paper in two.
     */
    public function fold()
    {
        $this->area /= 2;
    }
}

class Papyrus extends Paper
{
    public function fold()
    {
        throw new CanNotFoldException(
            "I break when I fold"
        );
    }
}
                    </code></pre>
                </article>
                <aside class="notes">
                    <ul>
                        <li>Now, Papyrus can't be used!</li>
                        <li>@throws CanNotFoldException in Paper::fold</li>
                        <li>of: @throws \Exception</li>
                        <li>Preservation of supertype's invariants</li>
                    </ul>
                </aside>
            </section>

            <section>
                <header>
                    <h3><span style="font-size: 85%">Strengthening Preconditions</span></h3>
                    <small>Warning: Argumentative</small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
interface IEngine {}
class JetEngine implements IEngine {}

class JumboJet
{
    public function addEngine(IEngine $engine)
    {
        // ...
    }
}

class Origami
{
    public function makeAirplane(Paper $paper)
    {
        // Turn $paper into JumboJet somehow
        $airplane->addEngine(new JetEngine);
    }
}
                    </code></pre>
                    <pre class="fragment"><code class="php" data-trim data-noescape>
class Propellor implements IEngine {}

class Triplane extends JumboJet
{
    public function addEngine(Propellor $engine)
    {
        // ...
    }
}
                    </code></pre>
                </article>
                <aside class="notes">
                    <ul>
                        <li>I'm just being more strict than its parent class</li>
                        <li>Thankfully, throws a warning</li>
                    </ul>
                </aside>
            </section>

            <section>
                <header>
                    <h3><span style="font-size: 85%">Strengthening Preconditions</span></h3>
                    <small>We have a problem</small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
interface IEngine
{
    /**
     * @return int  The engine's max speed in m/s.
     */
    public function getMaxSpeed();
}

class SpaceShuttle extends JumboJet
{
    public function addEngine(IEngine $engine)
    {
        if ($engine->getMaxSpeed() < 11200) {
            throw new InvalidEngineException(
                "Please ensure the engine is " .
                "faster than escape velocity"
            );
        }
        // ...
    }
}
                    </code></pre>
                </article>
                <aside class="notes">
                    <ul>
                    </ul>
                </aside>
            </section>




            <section>
                <header>
                    <h3><span style="font-size: 85%">Weakening Postconditions</span></h3>
                    <small></small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
class SlingShotPropelledShuttle extends SpaceShuttle
{
    public function addEngine(IEngine $engine)
    {
        if ($engine->getMaxSpeed() < 11200) {
            $this->setSelfPropelled(false);
        }

        // ...
    }
}
                    </code></pre>
                    <pre class="fragment"><code class="php" data-trim data-noescape>
class Launcher
{
    /**
     * Increases the $shuttle's engine's speed until
     * escape velocity has been reached.
     */
    public function escapeWorld(SpaceShuttle $shuttle)
    {
        $engine = $shuttle->getEngine();
        while ($shuttle->getSpeed() < 11200) {
            $engine->goFaster();
        }
    }
}
                    </code></pre>
                </article>
            </section>

            <section>
                <header>
                    <h3>History Constraint</h3>
                    <small></small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
class SpaceShuttle
{
    public function launch(
        SpaceTimeCoordinates $destination
    ) {
        // Validate spaceshuttle not already launched

        $this->destination = $destination;

        $shuttle->launch();
    }
}
                    </code></pre>
                    <pre class="fragment"><code class="php" data-trim data-noescape>
class LawsOfNatureDefyingShuttle extends SpaceShuttle
{
    public function changeDestination(
        SpaceTimeCoordinates $destination
    ) {
        $this->destination = $destination;
    }
}
                    </code></pre>
                </article>
            </section>

            <section>
                <header>
                    <h3>Protocols</h3>
                    <small>Code isn't everything</small>
                </header>
                <article>
                    <h5 style="text-align: left">Atomicity in single queue</h5>
                    <ul>
                        <li>AMQP: yes</li>
                        <li class="fragment">RabbitMQ: no</li>
                    </ul>
                </article>
                <aside class="notes">
                    <ul>
                        <li>Browser compatibility?</li>
                    </ul>
                </aside>
            </section>
        </section>






        <!-- DIP -->
        <section>
            <section class="with-clouds">
                <article>
                    <header>
                        <h2>Dependency Inversion</h2>
                        <small>I’m not responsible for my kids' actions</small>
                    </header>
                </article>
            </section>

            <section>
                <header>
                    <h3>Abstract classes</h3>
                    <small>Extends is evil</small>
                </header>
                <article>
                    <pre><code class="php" data-trim data-noescape>
                    </code></pre>
                </article>
            </section>
        </section>

        <!-- WRAP UP -->
        <section>
            <section class="with-clouds">
                <article>
                    <header>
                        <h2>Questions?</h2>
                        <small>No, everything was absolutely clear, and I’ll never do things wrong again</small>
                    </header>
                </article>
            </section>

            <section id="further-reading">
                <header>
                    <h3>Further reading</h3>
                    <small></small>
                </header>
                <article>
                    <ol class="references">
                        <li>Liskov, B. H.; Wing, J. M. (1994). A behavioral notion of subtyping. ACM Trans. Program. Lang. Syst. 16 (6). pp. 1811–1841. doi:10.1145/197320.197383.</li>
                        <li><a href="https://www.rabbitmq.com/semantics.html">https://www.rabbitmq.com/semantics.html</a></li>
                        <li><a href="http://blog.developers.nl/">http://blog.developers.nl/</a></li>
                    </ol>
                </article>
            </section>

            <section>
                <header>
                    <h3>Joind.In</h3>
                    <small>Note to self: Act as if I care</small>
                </header>
                <article>
                    <figure>
                        <img src="assets/joindin-qrcode.png" style="width: 25vw; max-width: 50vh; height: 25vw; max-height: 50vh;"/>
                        <figcaption>
                            <a href="https://joind.in/talk/aae1f">https://joind.in/talk/aae1f</a>
                        </figcaption>
                    </figure>
                </article>
            </section>
        </section>
    </div>
</div>

<script src="node_modules/reveal.js/lib/js/head.min.js"></script>
<script src="node_modules/reveal.js/js/reveal.js"></script>
<script src="theme/js/developers.nl.js"></script>

<script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: false,
        progress: false,
        slideNumber: false,
        history: true,
        center: true,
        embedded: false,
        backgroundTransition: 'none',
        mouseWheel: false,
//        transition: 'none',
//        transition: 'fade',
//        transition: 'slide',
//        transition: 'convex',
//        transition: 'concave',
        transition: 'zoom',

        zoomKey: 'ctrl',

        width: '100%',
        height: '100%',
        margin: 0,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
//            { src: 'theme/js/reveal-mouseclick-nav.js', async: true},
            { src: 'node_modules/reveal.js/plugin/zoom-js/zoom.js', async: true},
            { src: 'node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'node_modules/reveal.js/plugin/notes/notes.js', async: true }
        ]
    });
</script>
</body>
</html>